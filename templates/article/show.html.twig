{% extends 'base.html.twig' %}

{% block title %}{{ article.title }}{% endblock %}

{% block body %}
    <div class="row m-0 container-lg m-lg-auto">

        <main class="col-12 col-md-9">
            <article>
            <!-- BLOCK ARTICLE -->
                <section class="block-article row">
                    <span class="col-12 pl-0 border-bottom border-dark mb-2">{{ article.categorie.designation }}</span>
                    <h1 class="mainTitle">{{ article.title }}</h1>
                    <small class="mt-0 col-12 pl-0">{{ 'Publié le '~ article.artCreatedAt|date('d-m-Y') }}</small>
                    <img class="p-0 mt-2 col-12" src="{{ asset('images/'~ article.mainImage) }}" alt="{{ article.mainImage }}">
                    <h2>{{ article.secondaryTitle }}</h2>
                    <p class="mt-3">{{ article.content | nl2br }}</p>
                </section>

            <!-- BLOCK GALERIE -->
                <section class="block-galerie bg-secondary my-2 row">
                    Galerie des médias
                </section>

            <!-- BLOCK AUTEUR -->
                <section class="banner-author bg-info row">
                    <p class="text-white border-bottom m-0 pl-2 col-12"><em>
                    Cet article a été rédigé par
                    </em></p>
                    <div class="d-flex">
                        <div class="pl-1">
                            <img id="avatar-author" class="rounded-circle p-2" src="{{ asset('images/avatars/'~ article.user.avatar) }}" alt="">
                        </div>
                        <div>
                            <p class="pt-2 mb-0">
                                <strong> {{ article.user.firstName ~ ' ' ~  article.user.lastName }} </strong>
                            </p>
                            <p>{{ article.user.description }}</p>
                        </div>
                    </div>
                </section>
            </article>

            <!-- BLOCK COMMENTAIRES  -->
            {% if(commentaires) %}
                <hr>
            {% for commentaire in commentaires %}

                <div class="d-flex">
                    <img id="avatar-author" class="rounded-circle p-2 border border-danger" src="{{ asset('images/logo/logo.png') }}" alt="avatar">
                    <div class="ml-3 mt-4"> le {{ commentaire.commentAt|date('d F Y à H:i:s') }}</div>
                </div>
                <div class="my-3">
                    {{ commentaire.comment }}
                </div>
                <div>
                    <button id="like" class="btn btn-outline-success">
                        <i class="fa fa-thumbs-up"><span class="badge ml-2">0</span></i>
                    </button> &nbsp;
                    <button id="dislike" class="btn btn-outline-warning">
                        <i class="fa fa-thumbs-down"><span class="badge ml-2">0</span></i>
                    </button>
                </div>
                <hr class="border-bottom border-dark">
            {% endfor %}

            {% endif %}
            <!-- FORM COMMENTAIRES  -->
            <section class="col-12 mt-3 py-2 bg-info">
                <h3>Participer à la discussion</h3>
                {{ form_start(form) }}
                {{ form_end(form) }}
            </section>
        </main>

        <!-- ASIDE -->
        <aside class="col-3 p-2 border-left">
            <p class="border-bottom border-dark p-0">{{ aside|length > 1 ? "Dans la même catégorie" : "Ajouté récemment" }}</p>
            <div class="asideArticles mx-0">
            {% if aside|length > 1 %}
                {% for a in aside %}
                    {% if (article.categorie is same as(a.categorie)) and (article.id is not same as(a.id)) %}
                        <a href="{{ path('article_show', {'id': a.id}) }}" class="text-decoration-none text-dark d-flex flex-column justify-content-end mb-2" 
                         style="background-image: url( {{ asset('images/'~ a.mainImage) }} )">
                            <span class="aside-title h5">{{ a.title }}</span>
                        </a>
                    {% endif %}
                {% endfor %}
            {# le (else) ne fonctionne pas #}
            {% else %}
                {% for l in last %}
                    {% if article.id is not same as(l.id) %}
                        <a href="{{ path('article_show', {'id': l.id}) }}" class="text-decoration-none text-dark d-flex flex-column justify-content-end mb-2"
                           style="background-image: url( {{ asset('images/'~ l.mainImage) }} )">
                            <span class="aside-title h5">{{ l.title }}</span>
                        </a>
                    {% endif %}
                {% endfor %}
            {% endif %}
            </div>
        </aside>
    </div>

{% endblock %}
